<!DOCTYPE html>
<html>
<link href="https://fonts.cdnfonts.com/css/chalkduster" rel="stylesheet">
<style>
    @import url('https://fonts.cdnfonts.com/css/chalkduster');
</style>

<head>
    <!--<script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>-->

	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>-->
    <script src="http://www.google.com/jsapi" type="text/javascript"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

    <link href="styles.css" rel="stylesheet" />
    <script src="script.js"></script>

    <link rel="icon" type="image/png" href="webpage_assets/dreamsim_icon.png" />

    <title>DreamSim: Learning New Dimensions of Human Visual Similarity using Synthetic Data</title>
    <meta property="og:image" content="Path to my teaser.png">
    <!-- Facebook automatically scrapes this. Go to https://developers.facebook.com/tools/debug/ if you update and want to force Facebook to rescrape. -->
    <meta property="og:title" content="Creative and Descriptive Paper Title.">
    <meta property="og:description" content="Paper description.">

    <!-- Get from Google Analytics -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src=""></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-75863369-6');
    </script>
</head>

<body>
    <br>
    <center>
        <span class="near-black" style="font-size:36px">DreamSim: Learning New Dimensions of</span>
        <br>
        <span class="near-black" style="font-size:36px">Human Visual Similarity using Synthetic Data</span>
        <br>
        <table align="center" width="900px">
            <tbody>
                <tr>
                    <td align="center" width="215px">
                        <center>
                            <span style="font-size:24px"><a href="https://stephanie-fu.github.io/">Stephanie
                                    Fu</a><sup style="vertical-align: sub;">*</sup><sup style="font-size: 0.7em;">1</sup>
                                </span>
                        </center>
                    </td>
                    <td align="center" width="235px">
                        <center>
                            <span style="font-size:24px"><a href="https://netanel-tamir.github.io/">Netanel Y.
                                    Tamir</a><sup style="vertical-align: sub;">*</sup><sup
                                        style="font-size: 0.7em;">2</sup></span>
                        </center>
                    </td>
                    <td align="center" width="260px">
                        <center>
                            <span style="font-size:24px"><a href="https://ssundaram21.github.io/">Shobhita
                                    Sundaram</a><sup style="vertical-align: sub;">*</sup><sup
                                        style="font-size: 0.7em;">1</sup></span>
                        </center>
                    </td>
                    <td align="center" width="190px">
                        <center>
                            <span style="font-size:24px"><a href="https://people.csail.mit.edu/lrchai/">Lucy
                                    Chai</a><sup style="font-size: 0.7em;">1</sup></span>
                        </center>
                    </td>
                </tr>
            </tbody>
        </table>
        <table align="center" width="675px">
            <tbody>
                <tr>
                    <td align="center" width="225px">
                        <center>
                            <span style="font-size:24px"><a href="http://richzhang.github.io/">Richard Zhang</a><sup
                                        style="font-size: 0.7em;">3</sup></span>
                        </center>
                    </td>
                    <td align="center" width="225px">
                        <center>
                            <span style="font-size:24px"><a href="https://www.weizmann.ac.il/math/dekel/home">Tali
                                    Dekel</a><sup style="font-size: 0.7em;">2</sup></span>
                        </center>
                    </td>
                    <td align="center" width="225px">
                        <center>
                            <span style="font-size:24px"><a href="http://web.mit.edu/phillipi/">Phillip Isola</a><sup
                                        style="font-size: 0.7em;">1</sup></span>
                        </center>
                    </td>
                </tr>
            </tbody>
        </table>
        <table align="center" width="500px">
            <tbody>
                <tr>
                    <td align="center" width="50px">
                        <center>
                            <span style="font-size:18px"><sup>1</sup>MIT</span>
                        </center>
                    </td>
                    <td align="center" width="300px">
                        <center>
                            <span style="font-size:18px"><sup>2</sup>Weizmann Institute of Science</span>
                        </center>
                    </td>
                    <td align="center" width="150px">
                        <center>
                            <span style="font-size:18px"><sup>3</sup>Adobe Research</span>
                        </center>
                    </td>
                </tr>
            </tbody>
        </table>
        <table align="center" width="500px">
            <tbody>
                <tr>
                    <td align="center" width="500px">
                        <center>
                            <i><span style="font-size:14px">* Equal contribution, order decided by random
                                    seed</span></i>
                        </center>
                    </td>
                </tr>
            </tbody>
        </table>
        <table width="600" border="0" align="center" class="menu"
            style="margin-bottom: 20px;margin-top: 20px;font-weight: bold;font-size: 20px;">
            <tbody>
                <tr>
                    <td align="center">
                        <a class="bg-near-black f6 no_hover br-pill ph3 pv2 dib" href="" target="_blank">Paper</a>
                        <a class="bg-near-black f6 no_hover br-pill ph3 pv2 dib" href="supplemental.html" target="_blank">Supplementary Material</a>
                        <a class="bg-near-black f6 no_hover br-pill ph3 pv2 dib" href="" target="_blank">Code</a>
                        <a class="bg-near-black f6 no_hover br-pill ph3 pv2 dib" href="#bibtex" id="bibtex_link" target="_self">Bibtex</a>
                        <!-- <a href="">Paper</a> | <a href="supplemental.html">Supplementary Material</a> |
                        <a href="">Code</a> | <a href="#bibtex" id="bibtex_link" target="_self">Bibtex</a> -->
                    </td>
                </tr>
            </tbody>
        </table>

    </center>

    <center>
        <img class="round" style="width:900px" src="./webpage_assets/teaser.png">
    </center>
    <br>
	<p id="teaser-description">
        <span id="bold">Which image, A or B, is most similar to the reference?</span> 
		We generate a new benchmark of synthetic image triplets that span a wide range of mid-level variations, labeled with human similarity judgments.
		The dots below each image indicate which image is considered most similar to the reference by humans vs several existing metrics and our new metric, DreamSim.
    </p>
	<br>
    <hr>

    <center>
        <h1>Abstract</h1>
    </center>
    <table align="center" width="900px">

        <tbody>
            <tr>
                <td>
                    Current perceptual similarity metrics operate at the level of pixels and patches.
                    These metrics compare images in terms of their low-level colors and textures, but
                    fail to capture mid-level similarities, and differences, in image layout, object poses,
                    and semantic content. In this paper, we develop a perceptual metric that assesses
                    images holistically. Our first step is to collect a new dataset of human similarity
                    judgments over image pairs that are alike in diverse ways. Critical to this dataset
                    is that judgments are nearly automatic and shared by all observers. To achieve
                    this we use recent text-to-image models to create synthetic pairs that are perturbed
                    along various dimensions. We observe that popular perceptual metrics fall short
                    of explaining our new data, and we introduce a new metric, DreamSim, tuned to
                    better align with human perception. We analyze how our metric is affected by
                    different visual attributes, and find that it focuses heavily on foreground objects and
                    semantic content while also being sensitive to color and layout. Notably, despite
                    being trained on synthetic data, our metric generalizes to real images, giving strong
                    results on retrieval and reconstruction tasks. Furthermore, our metric outperforms
                    both prior learned metrics and recent large vision models on these tasks.

                </td>
            </tr>
        </tbody>
    </table>
    <br>
    <hr>
    <center>
        <h1>Installation and Usage</h1>
    </center>
    <div class="container-fluid" id="code-container" align="center" width="900px">
        <div class="row">
            <div class="col" id="pip-container" class="code-col" style="flex-direction: column;display:flex;" >
            <p>Installation:</p>
            <code>
                pip install dreamsim
            </code>
			<br>
			<div style="flex-grow: 1;"></div>
			<p>Preliminaries:</p>
            <code>
            from dreamsim import dreamsim
			<br>
			from PIL import Image
			<br>
			<br>
			model, preprocess = dreamsim(pretrained=True, cache_dir="~/.cache")
            </code>
            </div>
            <div class="col" id="example-container" class="code-col" style="flex-direction: column;display:flex;">
                <p>Usage:</p>
                <code>
				# Feature extraction
				<br>
                img1 = preprocess(Image.open("img1_path"))
                <br><br>
                embedding = model.embed(img1)
                <br>
                <br>
				# Perceptual similarity metric
				<br>
                img1 = preprocess(Image.open("img1_path"))
                <br>
                img2 = preprocess(Image.open("img2_path"))
                <br>
				<br>
                distance = model(img1, img2)
            </code>
            </div>
        </div>
    </div>
    <br>
    <hr>


    <center>
        <h1>Method</h1>
    </center>

    <center>
        <div class="container-fluid" id="method-container" align="center" width="900px">
            <div class="row">
                <div class="col" id="method-figure">
                    <img class="round" style="width:500px" src="./webpage_assets/method.png">
                </div>
                <div class="col" id="method-description">
                    Our perceptual metric is a pairwise image distance, computed as the cosine distance
                    between concatenated backbone model features. We train via a hinge loss on image triplets,
                    training via <a href="https://arxiv.org/abs/2106.09685">Low-Rank Adaptation (LoRA)</a>.
                </div>
            </div>
        </div>

    </center>
    <br>
    <hr>
    <center>
        <h1>Nearest Neighbors Experiment</h1>
    </center>
    <br>
    <table width="900px" border="0" align="center">
        <tbody>
            <tr>
                <div id="nnCarousel" class="carousel slide teaser-carousel" data-ride="carousel" data-interval="7000">
				    <ol class="carousel-indicators">
                        <li data-target="#nnCarousel" data-slide-to="0" class="active"></li>
                        <li data-target="#nnCarousel" data-slide-to="1"></li>
                        <li data-target="#nnCarousel" data-slide-to="2"></li>
                        <li data-target="#nnCarousel" data-slide-to="3"></li>
                        <li data-target="#nnCarousel" data-slide-to="4"></li>
                        <li data-target="#nnCarousel" data-slide-to="5"></li>
                        <li data-target="#nnCarousel" data-slide-to="6"></li>
                        <li data-target="#nnCarousel" data-slide-to="7"></li>
                        <li data-target="#nnCarousel" data-slide-to="8"></li>
                        <li data-target="#nnCarousel" data-slide-to="9"></li>
                    </ol>

                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <div>
                                <img class="teaser-img" src="./webpage_assets/nn_1.png">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="./webpage_assets/nn_7.png">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="./webpage_assets/nn_3.png">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="./webpage_assets/nn_10.png">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="./webpage_assets/nn_8.png">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="./webpage_assets/nn_5.png">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="./webpage_assets/nn_6.png">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="./webpage_assets/nn_2.png">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="./webpage_assets/nn_9.png">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="teaser-img" src="./webpage_assets/nn_4.png">
                            </div>
                        </div>
                    </div>

                    <a class="carousel-control-prev" href="#nnCarousel" role="button" data-slide="prev"
                        style="height: 500px;">
                        <div class="slider-navigation-previous">
                            <svg viewBox="0 0 50 80" xml:space="preserve" style="margin-right: 4px;">
                                <polyline fill="white" stroke-width=".5em" stroke-linecap="round"
                                    stroke-linejoin="round" points="45.63,75.8 0.375,38.087 45.63,0.375 ">
                                </polyline>
                            </svg>
                        </div>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#nnCarousel" role="button" data-slide="next"
                        style="height: 500px;">
                        <div class="slider-navigation-next">
                            <svg viewBox="0 0 50 80" xml:space="preserve" style="margin-left: 4px;">
                                <polyline fill="white" stroke-width=".5em" stroke-linecap="round"
                                    stroke-linejoin="round" points="0.375,0.375 45.63,38.087 0.375,75.8 ">
                                </polyline>
                            </svg>
                        </div>
                        <span class="sr-only">Next</span>
                    </a>
                </div>

            </tr>
        </tbody>
    </table>
    <br>
    <br>
    <br>
    <br>
    <br>
	<p id="nn-description">
        <span id="bold">Nearest-neighbor retrieval.</span>
        We perform a nearest neighbor search on the ImageNet-R and COCO datasets using different metrics.
		Although the datasets include images outside of our training domain, our model consistently retrieves neighbors with similar appearance and class to that of the query image.
    </p>
    <hr>
    <center>
        <h1>Inversion Experiment</h1>
    </center>
    <br>
    <table width="900px" border="0" align="center">
        <tbody>
            <tr>
                <div id="inversionCarousel" class="carousel slide inversion-carousel" data-ride="carousel"
                    data-interval="7000">
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <div>
                                <img class="inversion-img" src="./webpage_assets/inversion_1.png">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="inversion-img" src="./webpage_assets/inversion_2.png">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="inversion-img" src="./webpage_assets/inversion_3.png">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="inversion-img" src="./webpage_assets/inversion_4.png">
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div>
                                <img class="inversion-img" src="./webpage_assets/inversion_5.png">
                            </div>
                        </div>
                    </div>

                    <ol class="carousel-indicators" style="bottom: -35px;">
                        <li data-target="#inversionCarousel" data-slide-to="0" class="active"></li>
                        <li data-target="#inversionCarousel" data-slide-to="1"></li>
                        <li data-target="#inversionCarousel" data-slide-to="2"></li>
                        <li data-target="#inversionCarousel" data-slide-to="3"></li>
                        <li data-target="#inversionCarousel" data-slide-to="4"></li>
                    </ol>

                    <a class="carousel-control-prev" href="#inversionCarousel" role="button" data-slide="prev"
                        style="height: 500px;">
                        <div class="slider-navigation-previous">
                            <svg viewBox="0 0 50 80" xml:space="preserve" style="margin-right: 4px;">
                                <polyline fill="white" stroke-width=".5em" stroke-linecap="round"
                                    stroke-linejoin="round" points="45.63,75.8 0.375,38.087 45.63,0.375 ">
                                </polyline>
                            </svg>
                        </div>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#inversionCarousel" role="button" data-slide="next"
                        style="height: 500px;">
                        <div class="slider-navigation-next">
                            <svg viewBox="0 0 50 80" xml:space="preserve" style="margin-left: 4px;">
                                <polyline fill="white" stroke-width=".5em" stroke-linecap="round"
                                    stroke-linejoin="round" points="0.375,0.375 45.63,38.087 0.375,75.8 ">
                                </polyline>
                            </svg>
                        </div>
                        <span class="sr-only">Next</span>
                    </a>
                </div>

            </tr>
        </tbody>
    </table>
    <br>
    <p id="inversion-description">
        <span id="bold">Feature inversion across different metrics and image priors.</span>
        Given a target image, we optimize for an image, where the objective is to match the target image
        embedding of a given backbone.
        Without any image prior (Optimization), our metric recovers better the color, shape and semantics
        of the target image. With a weak image prior (DIP Inversion), our metric is better able to reproduce scene
        structure and semantics. Using a diffusion model as a strong prior, our metric better captures overall semantics
        and scene appearance.
    </p>
    <br>
    <hr>
    <center>
        <h1>Acknowledgements</h1>
        <table align="center" width="900px">
            <tbody>
                <tr>
                    <td>
                        We thank Jim DiCarlo, Liad Mudrik, Nitzan Censor for fruitful discussions throughout the project. Additionally, we thank Narek Tumanyan for his insightful comments over the course of the project. Finally, we thank Michelle Li for proofreading sections of this paper and offering helpful comments.
						<br>
						<br>
						This work was supported by the NSF GRFP Fellowship to Shobhita Sundaram, the Meta PhD Fellowship to Lucy Chai, the Israeli Science Foundation (grant 2303/20) to Tali Dekel, and the Packard Fellowship to Phillip Isola. 
					</td>
                </tr>
            </tbody>
        </table>
    </center>
    <br>
    <hr>
    <center>
        <h1 name="bibtex" id="bibtex">Bibtex</h1>
    </center>
    <div class="col" class="code-col">
        <code style="font-size: 14px;">
            @article{fu2023learning,<br>
                &ensp;title={Learning New Dimensions of Human Visual Similarity using Synthetic Data},<br>
                &ensp;author={Stephanie Fu* and Netanel Tamir* and Shobhita Sundaram* and Lucy Chai and Richard Zhang and Tali Dekel and Phillip Isola},<br>
                &ensp;journal={arXiv:ID},<br>
                &ensp;year={2023}<br>
              }
        </code>
    </div>
    <br>
    <hr>
</body>

</html>